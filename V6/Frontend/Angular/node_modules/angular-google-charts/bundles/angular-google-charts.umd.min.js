!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rxjs"),require("@angular/core"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("angular-google-charts",["exports","rxjs","@angular/core","rxjs/operators"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["angular-google-charts"]={},t.rxjs,t.ng.core,t.rxjs.operators)}(this,(function(t,e,r,a){"use strict";var o=function(){function t(t){this.editor=t,this.doneSubject=new e.Subject,this.addEventListeners()}return t.prototype.afterClosed=function(){return this.doneSubject.asObservable()},t.prototype.cancel=function(){this.editor.closeDialog()},t.prototype.addEventListeners=function(){var t=this;google.visualization.events.addOneTimeListener(this.editor,"ok",(function(){google.visualization.events.removeAllListeners(t.editor);var e=t.editor.getChartWrapper();t.doneSubject.next(e),t.doneSubject.complete()})),google.visualization.events.addOneTimeListener(this.editor,"cancel",(function(){google.visualization.events.removeAllListeners(t.editor),t.doneSubject.next(null),t.doneSubject.complete()}))},t}(),n=new r.InjectionToken("GOOGLE_CHARTS_CONFIG"),i={version:"current",safeMode:!1},s=function(){function t(t,r,a){this.zone=t,this.localeId=r,this.scriptSource="https://www.gstatic.com/charts/loader.js",this.scriptLoadSubject=new e.Subject,this.config=Object.assign(Object.assign({},i),a||{})}return t.prototype.isGoogleChartsAvailable=function(){return"undefined"!=typeof google&&void 0!==google.charts},t.prototype.loadChartPackages=function(){for(var t=this,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return this.loadGoogleCharts().pipe(a.switchMap((function(){return new e.Observable((function(e){var a={packages:r,language:t.localeId,mapsApiKey:t.config.mapsApiKey,safeMode:t.config.safeMode};google.charts.load(t.config.version,a),google.charts.setOnLoadCallback((function(){t.zone.run((function(){e.next(),e.complete()}))}))}))})))},t.prototype.loadGoogleCharts=function(){var t=this;if(this.isGoogleChartsAvailable())return e.of(null);if(!this.isLoadingGoogleCharts()){var r=this.createGoogleChartsScript();r.onload=function(){t.zone.run((function(){t.scriptLoadSubject.next(),t.scriptLoadSubject.complete()}))},r.onerror=function(){t.zone.run((function(){console.error("Failed to load the google charts script!"),t.scriptLoadSubject.error(new Error("Failed to load the google charts script!"))}))}}return this.scriptLoadSubject.asObservable()},t.prototype.isLoadingGoogleCharts=function(){return null!=this.getGoogleChartsScript()},t.prototype.getGoogleChartsScript=function(){var t=this;return Array.from(document.getElementsByTagName("script")).find((function(e){return e.src===t.scriptSource}))},t.prototype.createGoogleChartsScript=function(){var t=document.createElement("script");return t.type="text/javascript",t.src=this.scriptSource,t.async=!0,document.getElementsByTagName("head")[0].appendChild(t),t},t}();s.decorators=[{type:r.Injectable}],s.ctorParameters=function(){return[{type:r.NgZone},{type:String,decorators:[{type:r.Inject,args:[r.LOCALE_ID]}]},{type:void 0,decorators:[{type:r.Inject,args:[n]},{type:r.Optional}]}]};var p=function(){function t(t){this.scriptLoaderService=t,this.initializedSubject=new e.Subject}return Object.defineProperty(t.prototype,"initialized$",{get:function(){return this.initializedSubject.asObservable()},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.scriptLoaderService.loadChartPackages("charteditor").subscribe((function(){t.editor=new google.visualization.ChartEditor,t.initializedSubject.next(t.editor),t.initializedSubject.complete()}))},t.prototype.editChart=function(t,e){if(!t.chartWrapper)throw new Error("Chart wrapper is `undefined`. Please wait for the `initialized$` observable before trying to edit a chart.");if(!this.editor)throw new Error("Chart editor is `undefined`. Please wait for the `initialized$` observable before trying to edit a chart.");var r=new o(this.editor);return this.editor.openDialog(t.chartWrapper,e||{}),r.afterClosed().subscribe((function(e){e&&(t.chartWrapper=e)})),r},t}();p.decorators=[{type:r.Component,args:[{selector:"chart-editor",template:"<ng-content></ng-content>",host:{class:"chart-editor"},changeDetection:r.ChangeDetectionStrategy.OnPush}]}],p.ctorParameters=function(){return[{type:s}]};Object.create;function c(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],a=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&a>=t.length&&(t=void 0),{value:t&&t[a++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var a,o,n=r.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(t){o={error:t}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return i}function l(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(h(arguments[e]));return t}Object.create;var u=function(){function t(t){this.loaderService=t,this.error=new r.EventEmitter,this.ready=new r.EventEmitter,this.stateChange=new r.EventEmitter,this.id="_"+Math.random().toString(36).substr(2,9),this.wrapperReadySubject=new e.ReplaySubject(1)}return Object.defineProperty(t.prototype,"wrapperReady$",{get:function(){return this.wrapperReadySubject.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"controlWrapper",{get:function(){if(!this._controlWrapper)throw new Error("Cannot access the control wrapper before it being initialized.");return this._controlWrapper},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.loaderService.loadChartPackages("controls").subscribe((function(){t.createControlWrapper()}))},t.prototype.ngOnChanges=function(t){this._controlWrapper&&(t.type&&this._controlWrapper.setControlType(this.type),t.options&&this._controlWrapper.setOptions(this.options||{}),t.state&&this._controlWrapper.setState(this.state||{}))},t.prototype.createControlWrapper=function(){this._controlWrapper=new google.visualization.ControlWrapper({containerId:this.id,controlType:this.type,state:this.state,options:this.options}),this.addEventListeners(),this.wrapperReadySubject.next(this._controlWrapper)},t.prototype.addEventListeners=function(){var t=this;google.visualization.events.removeAllListeners(this._controlWrapper),google.visualization.events.addListener(this._controlWrapper,"ready",(function(e){return t.ready.emit(e)})),google.visualization.events.addListener(this._controlWrapper,"error",(function(e){return t.error.emit(e)})),google.visualization.events.addListener(this._controlWrapper,"statechange",(function(e){return t.stateChange.emit(e)}))},t}();u.decorators=[{type:r.Component,args:[{selector:"control-wrapper",template:"",host:{class:"control-wrapper"},exportAs:"controlWrapper",changeDetection:r.ChangeDetectionStrategy.OnPush}]}],u.ctorParameters=function(){return[{type:s}]},u.propDecorators={for:[{type:r.Input}],type:[{type:r.Input}],options:[{type:r.Input}],state:[{type:r.Input}],error:[{type:r.Output}],ready:[{type:r.Output}],stateChange:[{type:r.Output}],id:[{type:r.HostBinding,args:["id"]}]};var d=function(){function t(t,e){this.element=t,this.loaderService=e,this.ready=new r.EventEmitter,this.error=new r.EventEmitter,this.initialized=!1}return t.prototype.ngOnInit=function(){var t=this;this.loaderService.loadChartPackages("controls").subscribe((function(){t.createDataTable(),t.createDashboard(),t.initialized=!0}))},t.prototype.ngOnChanges=function(t){this.initialized&&(t.data||t.columns)&&(this.createDataTable(),this.dashboard.draw(this.dataTable))},t.prototype.createDashboard=function(){var t=this,r=this.controlWrappers.map((function(t){return t.wrapperReady$})),a=this.controlWrappers.map((function(t){return t.for})).map((function(t){return Array.isArray(t)?e.combineLatest(t.map((function(t){return t.wrapperReady$}))):t.wrapperReady$}));e.combineLatest(l(r,a)).subscribe((function(){t.dashboard=new google.visualization.Dashboard(t.element.nativeElement),t.initializeBindings(),t.registerEvents(),t.dashboard.draw(t.dataTable)}))},t.prototype.registerEvents=function(){var t=this;google.visualization.events.removeAllListeners(this.dashboard);var e=function(t,e,r){google.visualization.events.addListener(t,e,r)};e(this.dashboard,"ready",(function(){return t.ready.emit()})),e(this.dashboard,"error",(function(e){return t.error.emit(e)}))},t.prototype.initializeBindings=function(){var t=this;this.controlWrappers.forEach((function(e){if(Array.isArray(e.for)){var r=e.for.map((function(t){return t.chartWrapper}));t.dashboard.bind(e.controlWrapper,r)}else t.dashboard.bind(e.controlWrapper,e.for.chartWrapper)}))},t.prototype.createDataTable=function(){if(null!=this.data){var t=!0;null!=this.columns&&(t=!1),this.dataTable=google.visualization.arrayToDataTable(this.getDataAsTable(),t)}},t.prototype.getDataAsTable=function(){return this.columns?l([this.columns],this.data):this.data},t}();d.decorators=[{type:r.Component,args:[{selector:"dashboard",template:"<ng-content></ng-content>",changeDetection:r.ChangeDetectionStrategy.OnPush,exportAs:"dashboard",host:{class:"dashboard"}}]}],d.ctorParameters=function(){return[{type:r.ElementRef},{type:s}]},d.propDecorators={data:[{type:r.Input}],columns:[{type:r.Input}],ready:[{type:r.Output}],error:[{type:r.Output}],controlWrappers:[{type:r.ContentChildren,args:[u]}]};var y=function(){function t(t,a,o){this.element=t,this.scriptLoaderService=a,this.dashboard=o,this.options={},this.dynamicResize=!1,this.ready=new r.EventEmitter,this.error=new r.EventEmitter,this.select=new r.EventEmitter,this.mouseover=new r.EventEmitter,this.mouseleave=new r.EventEmitter,this.wrapperReadySubject=new e.ReplaySubject(1),this.initialized=!1}return Object.defineProperty(t.prototype,"chart",{get:function(){return this.chartWrapper.getChart()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapperReady$",{get:function(){return this.wrapperReadySubject.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chartWrapper",{get:function(){if(!this.wrapper)throw new Error("Trying to access the chart wrapper before it was fully initialized");return this.wrapper},set:function(t){this.wrapper=t,this.drawChart()},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.scriptLoaderService.loadChartPackages().subscribe((function(){t.createDataTable(),t.wrapper=new google.visualization.ChartWrapper({container:t.element.nativeElement,chartType:t.type,dataTable:t.dataTable,options:t.mergeOptions()}),t.registerChartEvents(),t.wrapperReadySubject.next(t.wrapper),t.initialized=!0,t.drawChart()}))},t.prototype.ngOnChanges=function(t){if(t.dynamicResize&&this.updateResizeListener(),this.initialized){var e=!1;(t.data||t.columns||t.formatters)&&(this.createDataTable(),this.wrapper.setDataTable(this.dataTable),e=!0),t.type&&(this.wrapper.setChartType(this.type),e=!0),(t.options||t.width||t.height||t.title)&&(this.wrapper.setOptions(this.mergeOptions()),e=!0),e&&this.drawChart()}},t.prototype.createDataTable=function(){if(null!=this.data){var t=!0;null!=this.columns&&(t=!1),this.dataTable=google.visualization.arrayToDataTable(this.getDataAsTable(),t),this.applyFormatters(this.dataTable)}else this.dataTable=void 0},t.prototype.getDataAsTable=function(){return this.columns?l([this.columns],this.data):this.data},t.prototype.updateResizeListener=function(){var t=this;null!=this.resizeSubscription&&(this.resizeSubscription.unsubscribe(),this.resizeSubscription=void 0),this.dynamicResize&&(this.resizeSubscription=e.fromEvent(window,"resize").pipe(a.debounceTime(100)).subscribe((function(){t.initialized&&t.drawChart()})))},t.prototype.mergeOptions=function(){return Object.assign({title:this.title,width:this.width,height:this.height},this.options)},t.prototype.applyFormatters=function(t){var e,r;if(null!=this.formatters)try{for(var a=c(this.formatters),o=a.next();!o.done;o=a.next()){var n=o.value;n.formatter.format(t,n.colIndex)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}},t.prototype.registerChartEvents=function(){var t=this;google.visualization.events.removeAllListeners(this.wrapper);var e=function(t,e,r){google.visualization.events.addListener(t,e,r)};e(this.wrapper,"ready",(function(){google.visualization.events.removeAllListeners(t.chart),e(t.chart,"onmouseover",(function(e){return t.mouseover.emit(e)})),e(t.chart,"onmouseout",(function(e){return t.mouseleave.emit(e)})),e(t.chart,"select",(function(){var e=t.chart.getSelection();t.select.emit({selection:e})})),t.ready.emit({chart:t.chart})})),e(this.wrapper,"error",(function(e){return t.error.emit(e)}))},t.prototype.drawChart=function(){null==this.dashboard&&this.wrapper.draw()},t}();y.decorators=[{type:r.Component,args:[{selector:"google-chart",template:"",host:{class:"google-chart"},exportAs:"googleChart",changeDetection:r.ChangeDetectionStrategy.OnPush,styles:[":host { width: fit-content; display: block; }"]}]}],y.ctorParameters=function(){return[{type:r.ElementRef},{type:s},{type:d,decorators:[{type:r.Optional}]}]},y.propDecorators={type:[{type:r.Input}],data:[{type:r.Input}],columns:[{type:r.Input}],title:[{type:r.Input}],width:[{type:r.Input}],height:[{type:r.Input}],options:[{type:r.Input}],formatters:[{type:r.Input}],dynamicResize:[{type:r.Input}],ready:[{type:r.Output}],error:[{type:r.Output}],select:[{type:r.Output}],mouseover:[{type:r.Output}],mouseleave:[{type:r.Output}]};var g,f,b=function(){function t(t,a){this.element=t,this.scriptLoaderService=a,this.error=new r.EventEmitter,this.ready=new r.EventEmitter,this.select=new r.EventEmitter,this.wrapperReadySubject=new e.ReplaySubject(1),this.initialized=!1}return Object.defineProperty(t.prototype,"chart",{get:function(){return this.chartWrapper.getChart()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapperReady$",{get:function(){return this.wrapperReadySubject.asObservable()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"chartWrapper",{get:function(){if(!this.wrapper)throw new Error("Cannot access the chart wrapper before initialization.");return this.wrapper},set:function(t){this.wrapper=t,this.drawChart()},enumerable:!1,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.scriptLoaderService.loadChartPackages().subscribe((function(){t.specs||(t.specs={});var e=t.specs,r=(e.containerId,e.container,function(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(a=Object.getOwnPropertySymbols(t);o<a.length;o++)e.indexOf(a[o])<0&&Object.prototype.propertyIsEnumerable.call(t,a[o])&&(r[a[o]]=t[a[o]])}return r}(e,["containerId","container"]));t.wrapper=new google.visualization.ChartWrapper(Object.assign(Object.assign({},r),{container:t.element.nativeElement})),t.registerChartEvents(),t.wrapperReadySubject.next(t.wrapper),t.drawChart(),t.initialized=!0}))},t.prototype.ngOnChanges=function(t){this.initialized&&t.specs&&(this.updateChart(),this.drawChart())},t.prototype.updateChart=function(){this.specs||(this.specs={}),this.wrapper.setChartType(this.specs.chartType),this.wrapper.setDataTable(this.specs.dataTable),this.wrapper.setDataSourceUrl(this.specs.dataSourceUrl),this.wrapper.setDataSourceUrl(this.specs.dataSourceUrl),this.wrapper.setQuery(this.specs.query),this.wrapper.setOptions(this.specs.options),this.wrapper.setRefreshInterval(this.specs.refreshInterval),this.wrapper.setView(this.specs.view)},t.prototype.drawChart=function(){this.wrapper&&this.wrapper.draw()},t.prototype.registerChartEvents=function(){var t=this;google.visualization.events.removeAllListeners(this.wrapper);var e=function(t,e,r){google.visualization.events.addListener(t,e,r)};e(this.wrapper,"ready",(function(){return t.ready.emit({chart:t.chart})})),e(this.wrapper,"error",(function(e){return t.error.emit(e)})),e(this.wrapper,"select",(function(){var e=t.chart.getSelection();t.select.emit({selection:e})}))},t}();b.decorators=[{type:r.Component,args:[{selector:"chart-wrapper",template:"",host:{class:"chart-wrapper"},exportAs:"chartWrapper",changeDetection:r.ChangeDetectionStrategy.OnPush,styles:[":host { width: fit-content; display: block; }"]}]}],b.ctorParameters=function(){return[{type:r.ElementRef},{type:s}]},b.propDecorators={specs:[{type:r.Input}],error:[{type:r.Output}],ready:[{type:r.Output}],select:[{type:r.Output}]},(g=t.ChartType||(t.ChartType={})).AnnotationChart="AnnotationChart",g.AreaChart="AreaChart",g.Bar="Bar",g.BarChart="BarChart",g.BubbleChart="BubbleChart",g.Calendar="Calendar",g.CandlestickChart="CandlestickChart",g.ColumnChart="ColumnChart",g.ComboChart="ComboChart",g.PieChart="PieChart",g.Gantt="Gantt",g.Gauge="Gauge",g.GeoChart="GeoChart",g.Histogram="Histogram",g.Line="Line",g.LineChart="LineChart",g.Map="Map",g.OrgChart="OrgChart",g.Sankey="Sankey",g.Scatter="Scatter",g.ScatterChart="ScatterChart",g.SteppedAreaChart="SteppedAreaChart",g.Table="Table",g.Timeline="Timeline",g.TreeMap="TreeMap",g.WordTree="wordtree";var C,v=((f={})[t.ChartType.AnnotationChart]="annotationchart",f[t.ChartType.AreaChart]="corechart",f[t.ChartType.Bar]="bar",f[t.ChartType.BarChart]="corechart",f[t.ChartType.BubbleChart]="corechart",f[t.ChartType.Calendar]="calendar",f[t.ChartType.CandlestickChart]="corechart",f[t.ChartType.ColumnChart]="corechart",f[t.ChartType.ComboChart]="corechart",f[t.ChartType.PieChart]="corechart",f[t.ChartType.Gantt]="gantt",f[t.ChartType.Gauge]="gauge",f[t.ChartType.GeoChart]="geochart",f[t.ChartType.Histogram]="corechart",f[t.ChartType.Line]="line",f[t.ChartType.LineChart]="corechart",f[t.ChartType.Map]="map",f[t.ChartType.OrgChart]="orgchart",f[t.ChartType.Sankey]="sankey",f[t.ChartType.Scatter]="scatter",f[t.ChartType.ScatterChart]="corechart",f[t.ChartType.SteppedAreaChart]="corechart",f[t.ChartType.Table]="table",f[t.ChartType.Timeline]="timeline",f[t.ChartType.TreeMap]="treemap",f[t.ChartType.WordTree]="wordtree",f);(C=t.FilterType||(t.FilterType={})).Category="CategoryFilter",C.ChartRange="ChartRangeFilter",C.DateRange="DateRangeFilter",C.NumberRange="NumberRangeFilter",C.String="StringFilter";var m=function(){function t(){}return t.forRoot=function(e){return void 0===e&&(e={}),{ngModule:t,providers:[{provide:n,useValue:e}]}},t}();m.decorators=[{type:r.NgModule,args:[{declarations:[y,b,d,u,p],providers:[s],exports:[y,b,d,u,p]}]}],t.ChartEditorComponent=p,t.ChartEditorRef=o,t.ChartWrapperComponent=b,t.ControlWrapperComponent=u,t.DashboardComponent=d,t.GoogleChartComponent=y,t.GoogleChartsModule=m,t.ScriptLoaderService=s,t.getPackageForChart=function(t){return v[t]},t.Éµa=n,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-google-charts.umd.min.js.map